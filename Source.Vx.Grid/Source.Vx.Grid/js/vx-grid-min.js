!function(){"use strict";function e(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"_"+e()}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.replaceAll=function(e,n){var t=new RegExp(e,"g");return this.replace(t,n)},angular.module("vx.grid.modules",["ngSanitize","ui.bootstrap","vs-repeat","angular-json-editor","duScroll"]).directive("vxGrid",function(){return{restrict:"E",scope:{config:"=",scrollParent:"="},controller:["$scope","$uibModal","$sce","$timeout","$rootScope","$window","$filter","$q",function(n,t,i,o,l,r,a,d){function c(e,n,t){var i=t+"_"+n+"_key_",o="string";return null==e.value?i+="null":null==e.value?i+="null":"object"!=typeof e.value?(i+=e.value.toString().replace(/\s+/g,"_"),o=e.type):(i+=JSON.stringify(e.value).replace(/\s+/g,"_"),o="object"),{key:i,type:o}}function f(e,n){var t="";return angular.forEach(e,function(i){var o=[];angular.forEach(n,function(n){if(n.indexOf(".")){n=n.split(".");var t=i;angular.forEach(n,function(e){null!==t&&void 0!==t&&(t=t[e])}),e=t}else e=i[n];var l=null!==e?e:" ";void 0===l||!angular.isObject(l)||l instanceof Date||(l=u(l)),o.push(l)}),t+=o+"\n"}),t}function s(e,n){return n+"\n"+e}function u(e){var n="";return angular.forEach(e,function(e,t){n+=t+":"+e+" "}),'"'+n+'"'}n.vxColSettings={},n.posLeft=1,n.posTop=0;var v=angular.element(r);n.getWindowDimensions=function(){return{h:v.height(),w:v.width()}},n.resetVxInstance=function(){n.vxColSettings={primaryId:null,dropdDownEnabled:{},dropdDownLoaded:{},dropdDownOpen:{},dropDownSort:{},dropDownFilters:{},dropDownGroup:{},colFiltersStatus:{},colFilterPairs:{},colFiltersActivated:{},lastProcessedForFilters:{},multiSelected:[],multiSelColDependent:!1,reverseSettings:{},groupPredicate:{},groupByColActivated:{},rowSelected:{},vxRowClass:{},vxRowSelectionDisable:{},revealWrapRowData:!1,selectAllEnabled:!0,menu:!1,xsViewEnabled:!1,xsRowTitleTemplateAvailable:!1,xsSearch:"",searchToken:"",latchExcess:3,inlineEditState:{},colWithInlineEdits:[],groupKeys:{},allRowSelected:!1,allRowSelectionDisabled:!1,filterSearchToken:{},saveInProgress:{}},n.vxConfig=angular.copy(n.config);var e=_.find(n.vxConfig.columnDefConfigs,function(e){return 1==e.primary}),t="_uid";if("undefined"!=typeof e&&null!=e?(_.each(n.vxConfig.vxData,function(n,i){1!=n.fillEmptyElement&&(n[e.id]=n[e.id].toString(),n[t]=n[e.id]),n._vxCreated=(new Date).getTime()}),t=e.id):_.each(n.vxConfig.vxData,function(e,n){e.primaryId=n}),n.vxColSettings.primaryId=t,1==n.vxConfig.inlineEditingEnabled){var i=_.find(n.vxConfig.columnDefConfigs,function(e){return 0==e.id.localeCompare("inlinediting")});if("undefined"==typeof i||null==i||i=={}){var o={id:"inlinediting",columnName:"Edit",renderDefn:!0,renderHeadDefn:!0,ddSort:!1,ddGroup:!1,ddFilters:!1,width:"50",locked:!0,headTabIndex:-1,cellDefn:'<div class="vx-row-edit icon-container" tabindex="0" vx-key="editRow(VX_ROW_POINT)" ng-show="vxColSettings.inlineEditState[VX_ROW_POINT] == false && vxColSettings.saveInProgress[VX_ROW_POINT] != true" role="button" aria-labelledby="vx_row_edit vx_row_sel_{{::row[vxColSettings.primaryId]}}" ><i class="icon icon-edit"></i></div><div class="vx-row-edit icon-container" ng-attr-vxdisabled="{{vxConfig.invalidRows[row[vxColSettings.primaryId]]}}" tabindex="0" vx-key="saveRow(VX_ROW_POINT)" ng-show="vxColSettings.inlineEditState[VX_ROW_POINT] == true && vxColSettings.saveInProgress[VX_ROW_POINT] != true" role="button" aria-labelledby="vx_row_save vx_row_sel_{{::row[vxColSettings.primaryId]}}" ><i class="icon icon-save"></i></div><div class="vx-row-edit icon-container loader" tabindex="0" ng-show="vxColSettings.saveInProgress[VX_ROW_POINT] == true" role="button" aria-labelledby="vx_row_sel_row vx_row_sel_{{::row[vxColSettings.primaryId]}}" ><img class="loader-row" src="/resource/loaderBlue30.GIF"></i></div>',inlineEditOnColumnEnabled:!1};n.vxConfig.columnDefConfigs.unshift(o)}_.each(n.vxConfig.vxData,function(e,t){var i=e[n.vxColSettings.primaryId];n.vxColSettings.inlineEditState[i]=!1})}if(1==n.vxConfig.selectionEnabled){var i=_.find(n.vxConfig.columnDefConfigs,function(e){return 0==e.id.localeCompare("checkbox")});if("undefined"==typeof i||null==i||i=={}){var o={id:"checkbox",columnName:"Row Selection",renderDefn:!0,renderHeadDefn:!0,ddSort:!1,ddGroup:!1,ddFilters:!1,width:"50",locked:!0,headTabIndex:-1,headerDefn:'<div class="vx-row-select"><span class="offscreen" id="vx_row_sel_row">Select Row</span><span class="offscreen" id="vx_row_sel_all_row">Select All Rows</span><input class="vx-row-select-toggle" type="checkbox" ng-model="vxColSettings.allRowSelected" ng-change="allRowSelectionChanged()" ng-disabled="vxColSettings.allRowSelectionDisabled" ng-if="vxConfig.allRowsSelectionEnabled" aria-labelledby="vx_row_sel_all_row"  /></div>',cellDefn:'<div class="vx-row-select"><input class="vx-row-select-toggle" type="checkbox" ng-model="vxColSettings.rowSelected[VX_ROW_POINT]" ng-change="rowSelectionChanged(row)" ng-disabled="vxColSettings.vxRowSelectionDisable[VX_ROW_POINT]" ng-attr-id="vx_row-sel_in{{::row[vxColSettings.primaryId]}}" aria-labelledby="vx_row_sel_row vx_row_sel_{{::row[vxColSettings.primaryId]}}" /></div>'};n.vxConfig.columnDefConfigs.unshift(o)}_.each(n.vxConfig.vxData,function(e,t){var i=e[n.vxColSettings.primaryId];n.vxColSettings.rowSelected[i]=!1,n.vxColSettings.vxRowSelectionDisable[i]=!1})}n.multiBoxFilters=[];var l=[{prop:"enableDropdownsInHeader",defValue:!1},{prop:"selectionEnabled",defValue:!1},{prop:"multiSelectionEnabled",defValue:!1},{prop:"showGridStats",defValue:!1},{prop:"showGridOptions",defValue:!1},{prop:"selectAllOnRenderAll",defValue:!1},{prop:"virtualization",defValue:!0},{prop:"pagination",defValue:!1},{prop:"pageLength",defValue:20},{prop:"data",defValue:[]},{prop:"vxFilteredData",defValue:[]},{prop:"xsRowTitleTemplate",defValue:'<div class="xsRowTemplate">{{row[vxColSettings.primaryId]}}</div>'},{prop:"inlineAddRowEnabled",defValue:!1},{prop:"inlineEditSyncEnabled",defValue:!1},{prop:"inlineDeletingEnabled",defValue:!1},{prop:"inlineSaveOverrideEnabled",defValue:!1},{prop:"inlineDeleteOverrideEnabled",defValue:!1},{prop:"jsonEditorEnabled",defValue:!1},{prop:"allRowsSelectionEnabled",defValue:!1},{prop:"sortPredicate",defValue:n.vxColSettings.primaryId},{prop:"reverseSortDirection",defValue:!1},{prop:"emptyFill",defValue:"<span>No records to display ...</span>"},{prop:"loaderGifSrc",defValue:"/resource/loaderWhite36.GIF"},{prop:"ariaPrimary",defValue:n.vxColSettings.primaryId},{prop:"xsTemplate",defValue:!1},{prop:"exportFileName",defValue:"ExcelSheet"},{prop:"exportEnabled",defValue:!1}];if(_.each(l,function(e){("undefined"===n.vxConfig[e.prop]||null==n.vxConfig[e.prop]||n.vxConfig[e.prop]=={})&&(n.vxConfig[e.prop]=e.defValue)}),n.vxColSettings.vxRowClass=n.vxConfig.initialRowClasses,n.getWindowDimensions().w<768&&(n.vxColSettings.xsViewEnabled=n.vxConfig.xsTemplate,n.vxColSettings.latchExcess=5),n.vxColSettings.selectAllOnRenderAll=n.vxConfig.selectAllOnRenderAll,_.each(n.vxConfig.columnDefConfigs,function(e){var t=[{prop:"renderDefn",defValue:!1},{prop:"renderHeadDefn",defValue:!1},{prop:"ddSort",defValue:!1},{prop:"ddGroup",defValue:!1},{prop:"ddFilters",defValue:!1},{prop:"ddFiltersWithSearch",defValue:!1},{prop:"dropDownEnabled",defValue:!1},{prop:"hidden",defValue:!1},{prop:"xsHidden",defValue:!1},{prop:"locked",defValue:!1},{prop:"primary",defValue:!1},{prop:"width",defValue:"200"},{prop:"headerDefn",defValue:""},{prop:"cellDefn",defValue:""},{prop:"filterCellDefn",defValue:""},{prop:"inlineEditOnColumnEnabled",defValue:!1},{prop:"inlineEditValidation",defValue:!1},{prop:"editDefn",defValue:null},{prop:"editDefnTemplate",defValue:null},{prop:"headTabIndex",defValue:0}];_.each(t,function(n){("undefined"===e[n.prop]||null==e[n.prop]||e[n.prop]=={})&&(e[n.prop]=n.defValue)}),e.effectiveWidth=e.width,e.idCollection=[];var i=[{prop:"orderLocked",defValue:!1},{prop:"widthLocked",defValue:!1},{prop:"visbilityLocked",defValue:!1}];_.each(i,function(n){"undefined"===e[n.prop]||null==e[n.prop]||e[n.prop]=={}?e[n.prop]=e.locked:e[n.prop]=e.locked||e[n.prop]}),n.vxColSettings.reverseSettings[e.id]=!1,"undefined"!=typeof e.dropDownEnabled&&null!=e.dropDownEnabled&&1==e.dropDownEnabled&&1==n.vxConfig.enableDropdownsInHeader?n.vxColSettings.dropdDownEnabled[e.id]=!0:n.vxColSettings.dropdDownEnabled[e.id]=!1,n.vxColSettings.dropdDownLoaded[e.id]=!1,n.vxColSettings.dropdDownOpen[e.id]=!1,"undefined"!=typeof e.renderDefn&&null!=e.renderDefn&&e.renderDefn!={}&&1==e.renderDefn&&(e.cellDefn=e.cellDefn.replaceAll("VX_ROW_POINT","row[vxColSettings.primaryId]"),e.cellDefn=e.cellDefn.replaceAll("VX_DATA_POINT","row[header.id]"),e.cellDefn=e.cellDefn.replaceAll("VX_ROW","row"),e.cellDefn=e.cellDefn.replaceAll("VX_CONFIG","vxConfig")),1==e.inlineEditOnColumnEnabled&&((""==e.editDefn||null==e.editDefn)&&(e.editDefn='<input class="vx-edit-input form-control" ng-model="VX_DATA_POINT" />'),e.editDefn=e.editDefn.replaceAll("VX_ROW_POINT","row[vxColSettings.primaryId]"),e.editDefn=e.editDefn.replaceAll("VX_DATA_POINT","row[header.id]"),e.editDefn=e.editDefn.replaceAll("VX_ROW","row"),e.editDefn=e.editDefn.replaceAll("VX_CONFIG","vxConfig"),n.vxColSettings.colWithInlineEdits.push(e.id),-1!=e.editDefn.indexOf("vx-keep-watch")&&(e.editDefn=e.editDefn.replaceAll("vx-keep-watch",'vx-keep-watch-row-id="{{row[vxColSettings.primaryId]}}" vx-keep-watch-field="'+e.id+'" vx-keep-watch')),1==e.inlineEditValidation&&(n.vxConfig.invalidRows={},n.vxConfig.invalidRowFields={},_.each(n.vxConfig.vxData,function(e,t){var i=e[n.vxColSettings.primaryId];n.vxConfig.invalidRows[i]=!1,n.vxConfig.invalidRowFields[i]={}}),e.editDefn=e.editDefn.replaceAll("VX_INVALID_ROW","vxConfig.invalidRows[row[vxColSettings.primaryId]] == true"),e.editDefn=e.editDefn.replaceAll("VX_INVALID_FIELD_ROW","vxConfig.invalidRowFields[row[vxColSettings.primaryId]]."+e.id+" == true")))}),n.vxConfig.columnDefConfigs=n.calculateEffectiveWidths(n.vxConfig.columnDefConfigs),"undefined"!=typeof n.vxConfig.multiSelectionDependentCol&&null!=n.vxConfig.multiSelectionDependentCol&&n.vxConfig.multiSelectionDependentCol!={}&&""!=n.vxConfig.multiSelectionDependentCol&&(n.vxColSettings.multiSelColDependent=!0),"undefined"!=typeof n.vxConfig.xsRowTitleTemplate&&null!=n.vxConfig.xsRowTitleTemplate&&n.vxConfig.xsRowTitleTemplate!={}&&""!=n.vxConfig.xsRowTitleTemplate&&(n.vxColSettings.xsRowTitleTemplateAvailable=!0),1==n.vxConfig.inlineAddRowEnabled&&("undefined"==typeof n.vxConfig.newRowTemplate||null==n.vxConfig.newRowTemplate||n.vxConfig.newRowTemplate=={}||""==n.vxConfig.newRowTemplate)){var r=angular.copy(n.vxConfig.data[0]);_.each(n.vxConfig.columnDefConfigs,function(e){switch(typeof n.vxConfig.newRowTemplate[e.id]){case"boolean":n.vxConfig.newRowTemplate[e.id]=!1;break;case"number":n.vxConfig.newRowTemplate[e.id]=0;break;case"string":n.vxConfig.newRowTemplate[e.id]="";break;default:n.vxConfig.newRowTemplate[e.id]=null}}),n.vxConfig.newRowTemplate=r}var a=n.$watch("getWindowDimensions()",function(e,t){e.w<768?n.vxColSettings.xsViewEnabled=!0:n.vxColSettings.xsViewEnabled=!1},!0);0==n.vxConfig.xsTemplate&&a(),v.bind("resize",function(){n.$apply()}),n.config.id=n.vxConfig.id=_.uniqueId("_vxUID_"),n.config.getVxCounts=function(){return"undefined"!=typeof n.vxConfig&&null!=n.vxConfig&&n.vxConfig!={}&&"undefined"!==n.vxConfig.id&&null!=n.vxConfig.id&&n.vxConfig.id!={}?{id:n.vxConfig.id,data:{vxAllDataLength:n.getAllRowLength(),vxFilteredDataLength:n.multiBoxFilters.length>0?n.vxConfig.vxFilteredData.length:0,vxSelectedDataLength:n.vxColSettings.multiSelected.length}}:void 0},n.config.getData=function(){return n.vxConfig.data},n.config.getActiveDataSet=function(){return n.vxConfig.vxData},n.config.getFilteredDataSet=function(){return n.vxConfig.vxFilteredData},n.config.setRowFieldValidation=function(e,t,i){if("undefined"==typeof n.vxConfig.invalidRowFields[e]&&(n.vxConfig.invalidRows[e]=!1,n.vxConfig.invalidRowFields[e]={}),1==n.vxConfig.inlineEditSyncEnabled){var o=_.filter(n.vxColSettings.multiSelected,function(n){return 0==n.localeCompare(e)});"undefined"!=typeof o&&null!=o&&o.length>0&&_.each(n.vxColSettings.multiSelected,function(e){n.vxConfig.invalidRows[e]=!i,n.vxConfig.invalidRowFields[e][t]=!i})}n.vxConfig.invalidRows[e]=!i,n.vxConfig.invalidRowFields[e][t]=!i},n.config.getSelectedRows=function(){return n.vxColSettings.multiSelected},n.config.getRowsBeingEdited=function(){var e=[];if("undefined"!=typeof n.vxColSettings.inlineEditState&&null!=n.vxColSettings.inlineEditState)for(var t in n.vxColSettings.inlineEditState)1==n.vxColSettings.inlineEditState[t]&&e.push(t);return e},n.config.modifyRows=function(e,t){var i=[];return _.each(e,function(e){var o=e[n.vxColSettings.primaryId],l=_.find(n.vxConfig.vxData,function(e){return 0==e[n.vxColSettings.primaryId].localeCompare(o)}),r=_.find(n.vxConfig.data,function(e){return 0==e[n.vxColSettings.primaryId].localeCompare(o)});if("undefined"!=typeof l&&"undefined"!=typeof r){if("undefined"==typeof t||0==t.length)for(var a in e)0!=a.localeCompare(n.vxColSettings.primaryId)&&(l[a]=e[a],r[a]=e[a]);else t.length>0&&_.each(t,function(n){l[n]=e[n],r[n]=e[n]});i.push(r)}}),i},n.config.selectRows=function(e){var t=[];return _.each(e,function(e){var i=n.vxColSettings.rowSelected[e];("undefined"==typeof i||null==i||0==i)&&(n.vxColSettings.rowSelected[e]=!0,n.vxColSettings.multiSelected.push(e),t.push(e))}),t},n.config.deselectRows=function(e){var t=[];return _.each(e,function(e){var i=n.vxColSettings.rowSelected[e];"undefined"!=typeof i&&1==i&&(n.vxColSettings.rowSelected[e]=!1,n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(n){0==e.localeCompare(n)}),t.push(e))}),t},n.config.sortByColumn=function(e,t){n.vxConfig.sortPredicate=e,n.vxConfig.reverseSortDirection=t},n.config.resetColumnFilters=function(e){_.each(e,function(e){n.vxColSettings.dropdDownLoaded[e]=!1,n.vxColSettings.colFilterPairs[e]={}})},n.buildFns(),n.config.changeRowClass=n.changeRowClass,n.$emit("vxGridSettingsBuilt",{id:n.vxConfig.id})},n.editRow=function(e){if(1==n.vxConfig.inlineEditSyncEnabled&&n.vxColSettings.multiSelected.length>0){var t=_.filter(n.vxColSettings.multiSelected,function(n){return 0==n.localeCompare(e)});"undefined"!=typeof t&&null!=t&&t.length>0&&_.each(n.vxColSettings.multiSelected,function(e){n.vxColSettings.inlineEditState[e]=!0})}n.vxColSettings.inlineEditState[e]=!0},n.editInProgressCount=function(){var e=0;if("undefined"!=typeof n.vxColSettings.inlineEditState&&null!=n.vxColSettings.inlineEditState)for(var t in n.vxColSettings.inlineEditState)e=1==n.vxColSettings.inlineEditState[t]?e+1:e;return e},n.$on("vxInlineEditFieldChange",function(e,t){if(1==n.vxConfig.inlineEditSyncEnabled){var i=_.filter(n.vxColSettings.multiSelected,function(e){return 0==e.localeCompare(t.rowId)});"undefined"!=typeof i&&null!=i&&i.length>0&&_.each(n.vxColSettings.multiSelected,function(e){var i=_.find(n.vxConfig.vxData,function(t){return t[n.vxColSettings.primaryId]==e});"undefined"!=typeof i&&null!=i&&1==n.vxColSettings.inlineEditState[e]&&(i[t.field]=t.value)})}}),n.savingRows=function(e){var t=_.find(n.vxConfig.vxData,function(t){return t[n.vxColSettings.primaryId]==e});if("undefined"!=typeof t&&1==t.newRow)if(1==n.vxConfig.inlineSaveOverrideEnabled){n.vxColSettings.saveInProgress[e]=!0;var i=d.defer();i.promise.then(function(i){"undefined"!=typeof t.row&&1==i.save?(t.newRow=!1,_.each(n.vxConfig.columnDefConfigs,function(e){t[e.id]=i.row[e.id]})):n.vxConfig.data.unshift(t),n.vxColSettings.inlineEditState[e]="undefined"!=typeof i.save&&null!=i.save&&1==i.save?!1:!0,n.$emit("vxGridRowSave",{id:n.vxConfig.id,data:t,save:!n.vxColSettings.inlineEditState[e]}),n.vxColSettings.saveInProgress[e]=!1},function(i){console.log("Error : Save Failed"),console.log(i),n.vxColSettings.saveInProgress[e]=!1,n.vxColSettings.inlineEditState[e]=!0,t.newRow=!0}),i.resolve(n.config.fnInlineSaveOverride(t,null))}else"undefined"!=typeof o?_.each(n.vxConfig.columnDefConfigs,function(e){o[e.id]=t[e.id]}):n.vxConfig.data.unshift(t),n.vxColSettings.inlineEditState[e]=!1,n.$emit("vxGridRowSaved",{id:n.vxConfig.id,data:t});else{var o=_.find(n.vxConfig.data,function(t){return t[n.vxColSettings.primaryId]==e});if("undefined"!=typeof t&&"undefined"!=typeof o&&1==n.vxConfig.inlineSaveOverrideEnabled){n.vxColSettings.saveInProgress[e]=!0;var i=d.defer();i.promise.then(function(i){"undefined"!=typeof i.row&&1==i.save&&_.each(n.vxColSettings.colWithInlineEdits,function(e){o[e]=i.row[e]}),n.vxColSettings.inlineEditState[e]="undefined"!=typeof i.save&&null!=i.save&&1==i.save?!1:!0,n.$emit("vxGridRowSave",{id:n.vxConfig.id,data:t,save:!n.vxColSettings.inlineEditState[e]}),n.vxColSettings.saveInProgress[e]=!1},function(t){console.log("Error : Save Failed"),console.log(t),n.vxColSettings.saveInProgress[e]=!1,n.vxColSettings.inlineEditState[e]=!0}),i.resolve(n.config.fnInlineSaveOverride(t,o))}}},n.saveRow=function(e){var t=!1;if(1==n.vxConfig.inlineEditSyncEnabled){var i=_.filter(n.vxColSettings.multiSelected,function(n){return 0==n.localeCompare(e)});"undefined"!=typeof i&&null!=i&&i.length>0&&_.each(n.vxColSettings.multiSelected,function(e){n.savingRows(e),t=!0})}t||n.savingRows(e)},n.revertEdits=function(){"undefined"!=typeof n.vxColSettings.multiSelected&&null!=n.vxColSettings.multiSelected&n.vxColSettings.multiSelected.length>0&&(_.each(n.vxColSettings.multiSelected,function(e){n.revertEditForRow(e),n.vxColSettings.rowSelected[e]=!1}),n.vxColSettings.multiSelected=[])},n.revertEditForRow=function(e){var t=_.find(n.vxConfig.vxData,function(t){return t[n.vxColSettings.primaryId]==e});if("undefined"!=typeof t&&1==t.newRow)n.vxColSettings.inlineEditState[e]=!1,n.vxColSettings.rowSelected[e]=!1,n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(n){0==e.localeCompare(n)}),n.vxConfig.vxData=_.reject(n.vxConfig.vxData,function(t){return 0==t[n.vxColSettings.primaryId].localeCompare(e)}),n.$emit("vxGridRowEditRevert",{id:n.vxConfig.id,data:t});else{var i=_.find(n.vxConfig.data,function(t){return t[n.vxColSettings.primaryId]==e});"undefined"!=typeof t&&"undefined"!=typeof i&&(_.each(n.vxColSettings.colWithInlineEdits,function(e){t[e]=i[e]}),n.vxColSettings.inlineEditState[e]=!1,n.vxColSettings.rowSelected[e]=!1,n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(n){0==e.localeCompare(n)}),n.$emit("vxGridRowEditRevert",{id:n.vxConfig.id,data:i}))}},n.addNewRow=function(){n.vxConfig.sortPredicate="_vxCreated",n.vxConfig.reverseSortDirection=!0;var t=angular.copy(n.vxConfig.newRowTemplate),i=e();t[n.vxColSettings.primaryId]=i,t.newRow=!0,t._vxCreated=(new Date).getTime(),n.vxColSettings.inlineEditState[i]=!0,n.vxConfig.vxData.unshift(t)},n.deleteRows=function(){if("undefined"!=typeof n.vxColSettings.multiSelected&&null!=n.vxColSettings.multiSelected&n.vxColSettings.multiSelected.length>0)if(1==n.vxConfig.inlineDeleteOverrideEnabled){_.each(n.vxColSettings.multiSelected,function(e){n.vxColSettings.saveInProgress[e]=!0});var e=d.defer(),t=angular.copy(_.filter(n.vxConfig.vxData,function(e){return 1==_.contains(n.vxColSettings.multiSelected,e[n.vxColSettings.primaryId])}));e.promise.then(function(e){if(e.rows.length>0){var t=_.map(e.rows,function(e){return e[n.vxColSettings.primaryId]});n.vxConfig.vxData=_.reject(n.vxConfig.vxData,function(e){return 1==_.contains(t,e[n.vxColSettings.primaryId])}),n.$emit("vxGridRowsDeleted",{id:n.vxConfig.id,data:t}),_.each(t,function(e){n.vxColSettings.inlineEditState[e]=!1,n.vxColSettings.rowSelected[e]=!1,n.vxColSettings.saveInProgress[e]=!1}),n.vxColSettings.multiSelected=_.difference(n.vxColSettings.multiSelected,t)}},function(e){console.log("Error : Save Failed"),console.log(e)}).then(function(){_.each(n.vxColSettings.multiSelected,function(e){n.vxColSettings.saveInProgress[e]=!1})}),e.resolve(n.config.fnInlineDeleteOverride(t))}else n.vxConfig.vxData=_.reject(n.vxConfig.vxData,function(e){return 1==_.contains(n.vxColSettings.multiSelected,e[n.vxColSettings.primaryId])}),n.$emit("vxGridRowsDeleted",{id:n.vxConfig.id,data:n.vxColSettings.multiSelected}),_.each(n.vxColSettings.multiSelected,function(e){n.vxColSettings.inlineEditState[e]=!1,n.vxColSettings.rowSelected[e]=!1}),n.vxColSettings.multiSelected=[]},n.activatePage=function(e){n.vxColSettings.activePage=e,n.vxColSettings.vxPageStartPosition=e>0?e*n.vxConfig.pageLength-1:0},n.debouncedSearch=_.debounce(function(){n.vxColSettings.xsSearch=angular.copy(n.vxColSettings.searchToken)},50),n.keyUpSearch=function(e){13==e.keyCode?n.vxColSettings.xsSearch=angular.copy(n.vxColSettings.searchToken):8==e.keyCode&&""==n.vxColSettings.searchToken&&(n.vxColSettings.xsSearch=angular.copy(n.vxColSettings.searchToken))},n.isValidHeaderName=function(e,n){return 0==e.renderHeadDefn&&"undefined"!=typeof n&&null!=n&&""!=n},n.headerClick=function(e,t){var i=!0,l=$(t.target);if("undefined"!=typeof l&&null!=l&l.length>0){var r=l.closest("ul.dropdown-menu");"undefined"!=typeof r&&null!=r&r.length>0&&(i=!1)}if(0!=i){_.each(n.vxConfig.columnDefConfigs,function(t){0!=t.id.localeCompare(e.id)&&(n.vxColSettings.dropdDownOpen[t.id]=!1)});var a=_.find(n.vxConfig.columnDefConfigs,function(n){return 0==n.id.localeCompare(e.id)});if("undefined"!=typeof a&&null!=a)if(0==n.vxColSettings.dropdDownEnabled[a.id])n.sortClick(e);else{n.vxColSettings.dropdDownLoaded[a.id]=!1,n.vxColSettings.dropdDownOpen[a.id]=!n.vxColSettings.dropdDownOpen[a.id];var d=_.filter(n.multiBoxFilters,function(e){return 0!=e.col.localeCompare(a.id)}),f=d.length>0,s=!1;"undefined"!=typeof n.vxColSettings.colFilterPairs[a.id]&&null!=n.vxColSettings.colFilterPairs[a.id]&&n.vxColSettings.colFilterPairs[a.id]!={}&&n.vxColSettings.colFilterPairs[a.id].length>0&&(s=!0),0==f&&1==s?(n.vxColSettings.dropdDownLoaded[a.id]=!0,_.each(n.vxColSettings.colFilterPairs[a.id],function(e){e.disabled=!1})):o(function(){if(a.idCollection=[],1==a.ddSort&&(n.vxColSettings.dropDownSort[a.id]=!0,a.idCollection.push(a.id+"_sort")),1==a.ddGroup&&(n.vxColSettings.dropDownGroup[a.id]=!0,a.idCollection.push(a.id+"_group"),a.idCollection.push(a.id+"_ungroup")),1==a.ddFilters){if(a.idCollection.push(a.id+"_clearfilters"),a.idCollection.push(a.id+"_searchfilters"),0==s){n.vxColSettings.dropDownFilters[a.id]=!0,n.vxColSettings.colFilterPairs[a.id]=[];var e=_.uniq(_.map(n.vxConfig.vxData,function(e){var n={value:e[a.id],type:""};return"undefined"!=typeof n.value&&null!=n.value&&n.value!={}&&"object"!=typeof n.value&&"number"!=typeof n.value?n.value=n.value.trim():"[object Date]"===Object.prototype.toString.call(n.value)&&(n.value=n.value.getTime(),n.type="date"),n}),function(e){return e.value});e=_.reject(e,function(e){return"undefined"==typeof e.value||e.value=={}}),_.each(e.sort(),function(e,t){var i=c(e,a.id,"col"),o=i.key,l=i.type,r=""===e.value||" "===e.value?"< blank >":e.value;r=null==e.value?" < null >":r;var d={key:o,label:e.value,name:r,col:a.id,type:l,disabled:!1,action:"filter"};"undefined"!=typeof a.filterCellDefn&&null!=a.filterCellDefn&&a.filterCellDefn!={}&&""!=a.filterCellDefn?(d.filterDefn=a.filterCellDefn.replaceAll("VX_DATA_POINT","filter.name"),d.filterDefnAvailable=!0):d.filterDefnAvailable=!1,n.vxColSettings.colFilterPairs[a.id].push(d),a.idCollection.push(a.id+"_filter_"+t),n.vxColSettings.colFiltersStatus[o]=!1}),n.vxColSettings.filterSearchToken[a.id]="",n.vxColSettings.colFiltersActivated[a.id]=!1}if(1==f){var t=_.last(n.multiBoxFilters),e=_.uniq(_.map(n.vxConfig.vxFilteredData,function(e){return e[a.id]}));0!=t.col.localeCompare(a.id)&&_.each(n.vxColSettings.colFilterPairs[a.id],function(n){1!=_.contains(e,n.label)?n.disabled=!0:n.disabled=!1})}}n.vxColSettings.dropdDownLoaded[a.id]=!0},500)}}},n.sortClick=function(e){var t=_.find(n.vxConfig.columnDefConfigs,function(n){return 0==n.id.localeCompare(e.id)});"undefined"!=typeof t&&null!=t&&t.ddSort&&(0!=n.vxConfig.sortPredicate.localeCompare(t.id)&&(n.vxConfig.sortPredicate=t.id),n.vxColSettings.reverseSettings[t.id]=!n.vxColSettings.reverseSettings[t.id],n.vxConfig.reverseSortDirection=n.vxColSettings.reverseSettings[t.id])},n.getVisibleHeaderCounts=function(){return _.filter(n.vxConfig.columnDefConfigs,function(e){return 1!=e.hidden}).length},n.groupClick=function(e){if(n.clearFilters(),1!=n.vxColSettings.groupByColActivated[e.id]){n.vxConfig.sortPredicate=null;var t=[],i=e.id,o=e.columnName,l=_.uniq(_.pluck(n.vxConfig.vxData,i)),r=_.groupBy(_.sortBy(n.vxConfig.vxData,i),i);n.vxColSettings.groupKeys[i]=[],_.each(l,function(e){var l=c(e,i,"groupcol").key;if(n.vxColSettings.groupKeys[i].push(l),r[e].length>0){n.vxColSettings.groupPredicate[l]=!1;var a={type:"groupRow",colName:o,col:i,value:e,groupId:l,cellDefn:'<div class="vx-row-select"><input class="vx-row-select-toggle" type="checkbox" ng-model="VX_ROW_POINT" ng-change="groupSelectionChanged(row)" /></div>'};a.cellDefn=a.cellDefn.replaceAll("VX_ROW_POINT","vxColSettings.groupPredicate[row.groupId]"),t.push(a),t=_.union(t,r[e])}}),n.vxConfig.vxData=t,n.vxColSettings.groupByColActivated[e.id]=!0}},n.unGroupClick=function(e){n.clearFilters(),1==n.vxColSettings.groupByColActivated[e.id]&&(n.vxConfig.sortPredicate=e.id,n.vxConfig.vxData=_.reject(n.vxConfig.vxData,function(e){return"undefined"!=typeof e.type&&null!=e.type?0==e.type.localeCompare("groupRow"):!1}),n.vxColSettings.groupByColActivated[e.id]=!1)},n.getAllRowLength=function(){var e=_.filter(n.vxConfig.data,function(e){return"undefined"==typeof e.type||null==e.type||0!=e.type.localeCompare("groupRow")}).length;return e},n.removeGroupings=function(){_.each(n.vxConfig.columnDefConfigs,function(e){n.unGroupClick(e)}),n.vxColSettings.groupPredicate={}},n.groupSelectionChanged=function(e){n.emitArray=[];var t=n.vxColSettings.groupPredicate[e.groupId],i=_.filter(n.vxConfig.vxFilteredData,function(n){return"groupRow"!=n.type&&0==n[e.col].localeCompare(e.value)});_.each(i,function(e){if(0==n.vxColSettings.multiSelColDependent||1==n.vxColSettings.multiSelColDependent&&0==e[n.vxConfig.multiSelectionDependentCol]){var i=e[n.vxColSettings.primaryId];if(n.vxColSettings.rowSelected[i]!=t){n.vxColSettings.rowSelected[i]=t;({key:e[n.vxConfig.onSelectionReturnCol],value:n.vxColSettings.rowSelected[i],_pKey:i});n.emitArray.push(i),t?n.vxColSettings.multiSelected.push(i):n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(e){return 0==e.localeCompare(i)})}}}),n.$emit("vxGridRwSelectionChange",{id:n.vxConfig.id,data:n.emitArray})},n.allRowSelectionChanged=function(){var e=n.vxColSettings.allRowSelected;1==e?(_.each(n.vxConfig.vxFilteredData,function(t){if(1!=t.fillEmptyElement){var i=t[n.vxColSettings.primaryId];0==n.vxColSettings.rowSelected[i]&&1==e&&(n.vxColSettings.rowSelected[i]=!0,n.vxColSettings.multiSelected.push(i))}}),_.each(n.vxConfig.columnDefConfigs,function(e){1==n.vxColSettings.dropDownGroup[e.id]&&1==n.vxColSettings.groupByColActivated[e.id]&&_.each(n.vxColSettings.groupKeys[e.id],function(e){n.vxColSettings.groupPredicate[e]=!0})}),n.$emit("vxGridRowAllSelectionChange",{id:n.vxConfig.id,data:{toggledTo:e,array:n.vxColSettings.multiSelected}})):0==e&&(n.clearSelection(),n.$emit("vxGridRowAllSelectionChange",{id:n.vxConfig.id,data:{toggledTo:e,array:n.vxColSettings.multiSelected}}))},n.rowSelectionChanged=function(e){var t=e[n.vxColSettings.primaryId],i={key:e[n.vxConfig.onSelectionReturnCol],value:n.vxColSettings.rowSelected[t],_pKey:t},o=!0;if(1==n.vxColSettings.rowSelected[t]&&1==n.vxColSettings.multiSelColDependent){o=!1;var l=n.vxConfig.multiSelectionDependentCol;if(1==e[l]&&0==n.vxColSettings.multiSelected.length)o=!0;else if(0==e[l]&&n.vxColSettings.multiSelected.length>=1){var r=n.vxColSettings.multiSelected[0],a=_.find(n.vxConfig.vxData,function(e){return 0==e[n.vxColSettings.primaryId].localeCompare(r)});"undefined"!=typeof a&&null!=a&&a!={}&&1==a[l]?(o=!1,n.vxColSettings.rowSelected[t]=!1):o=!0}else 0==e[l]?o=!0:n.vxColSettings.rowSelected[t]=!1}else 0==n.vxColSettings.rowSelected[t]&&(n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(e){return 0==e.localeCompare(t)}),o=!1,n.vxColSettings.allRowSelected=!1,n.$emit("vxGridRowSelectionChange",{id:n.vxConfig.id,data:i}));if(o){var d=_.find(n.vxColSettings.multiSelected,function(e){return 0==e.localeCompare(t)});("undefined"==typeof d||null==d)&&n.vxColSettings.multiSelected.push(t),n.$emit("vxGridRowSelectionChange",{id:n.vxConfig.id,data:i}),0==n.vxConfig.multiSelectionEnabled&&(_.each(n.vxColSettings.multiSelected,function(e){0!=e.localeCompare(t)&&(n.vxColSettings.rowSelected[e]=!1)}),n.vxColSettings.multiSelected=_.reject(n.vxColSettings.multiSelected,function(e){return 0!=e.localeCompare(t)}))}},n.filterClick=function(e,t){n.clearSelection();var i=n.vxColSettings.colFiltersStatus[t.key];if(0==i){n.multiBoxFilters=_.reject(n.multiBoxFilters,function(e){return 0==e.key.localeCompare(t.key)});var o=_.find(n.multiBoxFilters,function(e){return 0==e.col.localeCompare(t.col)});("undefined"==typeof o||null==o||o=={}||0==o.length)&&(n.vxColSettings.colFiltersActivated[e.id]=!1)}else{var l=_.find(n.multiBoxFilters,function(e){return 0==e.key.localeCompare(t.key)});("undefined"==typeof l||null==l||l=={})&&n.multiBoxFilters.push(t),n.vxColSettings.colFiltersActivated[e.id]=!0}},n.filterClearClick=function(e){if(1==n.vxColSettings.colFiltersActivated[e.id]){n.clearSelection();var t=_.filter(n.multiBoxFilters,function(n){return 0==n.col.localeCompare(e.id)});t.length>0&&_.each(t,function(e){n.vxColSettings.colFiltersStatus[e.key]=!1}),n.multiBoxFilters=_.reject(n.multiBoxFilters,function(n){return 0==n.col.localeCompare(e.id)}),n.vxColSettings.colFiltersActivated[e.id]=!1}},n.clearFilters=function(){n.multiBoxFilters.length>0&&_.each(n.vxConfig.columnDefConfigs,function(e){n.filterClearClick(e)}),n.multiBoxFilters=[]},n.selectAllFiltered=function(){n.vxColSettings.multiSelected.length>0&&n.clearSelection(),n.emitArray=[],_.each(n.vxConfig.vxFilteredData,function(e){if(0==n.vxColSettings.multiSelColDependent||1==n.vxColSettings.multiSelColDependent&&0==e[n.vxConfig.multiSelectionDependentCol]){n.vxColSettings.rowSelected[e[n.vxColSettings.primaryId]]=!0;var t=e[n.vxColSettings.primaryId],i={key:e[n.vxConfig.onSelectionReturnCol],value:n.vxColSettings.rowSelected[t],_pKey:t};if(n.emitArray.push(i),1==n.vxColSettings.rowSelected[t]){var o=_.find(n.vxColSettings.multiSelected,function(e){return 0==e.localeCompare(t)});("undefined"==typeof o||null==o)&&n.vxColSettings.multiSelected.push(t)}}}),n.$emit("vxGridRowMultiSelectionChange",{id:n.vxConfig.id,data:n.emitArray})},n.clearSelection=function(){n.emitArray=[],_.each(n.vxColSettings.multiSelected,function(e){n.vxColSettings.rowSelected[e]=!1;var t=_.find(n.vxConfig.vxData,function(t){return"groupRow"!=t.type&&0==t[n.vxColSettings.primaryId].localeCompare(e)});if("undefined"!=typeof t&&null!=t){var i={key:t[n.vxConfig.onSelectionReturnCol],value:n.vxColSettings.rowSelected[e],_pKey:e};n.emitArray.push(i)}n.vxColSettings.multiSelected=[],n.vxColSettings.allRowSelected=!1,_.each(n.vxConfig.columnDefConfigs,function(e){1==n.vxColSettings.dropDownGroup[e.id]&&1==n.vxColSettings.groupByColActivated[e.id]&&_.each(n.vxColSettings.groupKeys[e.id],function(e){n.vxColSettings.groupPredicate[e]=!1})})}),n.$emit("vxGridRowMultiSelectionChange",{id:n.vxConfig.id,data:n.emitArray})},n.upDownKeyDownHandlerHeaderMenu=function(e){var n=!1;if(40==e.keyCode){var t=$(e.target).find('[tabindex="0"]');t.length>0&&$(t[0]).focus()}n&&(e.stopPropagation(),e.preventDefault())},n.findIdToBeFocussed=function(e,n,t){var i=e;if(t)for(;i<=n.length;){var o=$("#"+n[i+1]);if($(o).is('[tabindex="0"]'))return n[i+1];i+=1}else if(!t)for(;i>=1;){var o=$("#"+n[i-1]);if($(o).is('[tabindex="0"]'))return n[i-1];i-=1}return e},n.findFocussable=function(e,t,i){var o=$(e).attr("id"),l=_.find(n.vxConfig.columnDefConfigs,function(e){return e.id==t});if("undefined"!=typeof l&&null!=l){
var r=l.idCollection,a=_.indexOf(r,o);return-1!=a&&a!=r.length&&1==i?n.findIdToBeFocussed(a,r,!0):-1!=a&&0!=a&&0==i?n.findIdToBeFocussed(a,r,!1):null}},n.upDowKeyDownHandlerHeaderMenuItems=function(e,t){var i=!1;if(40==e.keyCode){var o=n.findFocussable($(e.target),t,!0);$("#"+o).is('[tabindex="0"]')&&$("#"+o).focus()}else if(38==e.keyCode){var o=n.findFocussable($(e.target),t,!1);null==o?$(e.target).closest("th").focus():$("#"+o).is('[tabindex="0"]')&&$("#"+o).focus()}else if(27==e.keyCode&&1==n.vxColSettings.dropdDownOpen[t]){n.vxColSettings.dropdDownOpen[t]=!1;var l=$(e.target).closest("th");l&&l.length>0&&$(l).focus()}i&&(e.stopPropagation(),e.preventDefault())},n.openManageColumns=function(){var e=t.open({templateUrl:"template/vx-grid/vx-grid-manage-columns-modal.html",windowClass:"vxGridManageColMod",controller:["$scope","$uibModalInstance","originalSettings",function(e,n,t){e.headerSelected=null,e.headerSelectedForVisChange=null,e.copyForWidthVisChange=t,_.each(e.copyForWidthVisChange,function(e,n){e.order=n,e.chars=Math.ceil((e.width-20)/7),e.selected=!1}),e.swapAbove=function(n){if(0==n.locked){var t=n.order,i=n.order,o=!0;do{i-=1,o=!0;var l=_.find(e.copyForWidthVisChange,function(e){return e.order==i&&0==e.orderLocked});("undefined"==typeof l||null==l||l=={})&&(o=!1)}while(!o&&i>=0);if(o&&i>=0){var l=_.find(e.copyForWidthVisChange,function(e){return e.order==i&&0==e.orderLocked});"undefined"!=typeof l&&null!=l&&l!={}&&(l.order=t,n.order=i)}}},e.swapBelow=function(n){if(0==n.locked){var t=n.order,i=n.order,o=!0;do{i+=1,o=!0;var l=_.find(e.copyForWidthVisChange,function(e){return e.order==i&&0==e.orderLocked});("undefined"==typeof l||null==l||l=={})&&(o=!1)}while(!o&&i<=e.copyForWidthVisChange.length-1);if(o&&i<=e.copyForWidthVisChange.length-1){var l=_.find(e.copyForWidthVisChange,function(e){return e.order==i&&0==e.orderLocked});"undefined"!=typeof l&&null!=l&&l!={}&&(l.order=t,n.order=i)}}},e.makeVisible=function(n){var t=_.find(e.copyForWidthVisChange,function(e){return 0==e.id.localeCompare(n.id)});"undefined"!=typeof t&&null!=t&&t!={}&&0==t.visbilityLocked&&(t.hidden=!1)},e.makeHidden=function(n){var t=_.find(e.copyForWidthVisChange,function(e){return 0==e.id.localeCompare(n.id)});"undefined"!=typeof t&&null!=t&&t!={}&&0==t.visbilityLocked&&(t.hidden=!0)},e.saveChangeInConfig=function(){var t=[];t=_.sortBy(e.copyForWidthVisChange,function(n){var t=_.find(e.copyForWidthVisChange,function(e){return 0==e.id.localeCompare(n.id)});return"undefined"!=typeof t&&null!=t&&t!={}?t.order:1}),n.close(t)},e.widthChanged=function(e){e.width=Math.ceil(7*e.chars)+20},e.selectHeader=function(n){1!=n.locked&&(n.selected=!n.selected,_.each(e.copyForWidthVisChange,function(e){0!=e.id.localeCompare(n.id)&&(e.selected=!1)}),1==n.selected?e.headerSelected=n:e.headerSelected=null)},e.cancelChangeInConfig=function(){n.dismiss()},e.upDownKeyPressHandler=function(n){var t=!1;(38==n.keyCode||40==n.keyCode)&&(t=e.upDownMovement(n)),t&&(n.stopPropagation(),n.preventDefault())},e.upDownMovement=function(e){var n=!1;if(38==e.keyCode){var t=$(e.target).prev();t.length>0&&-1!=$(t[0]).attr("tabindex")&&$(t)[0].focus(),n=!0}else if(40==e.keyCode){var t=$(e.target).next();t.length>0&&-1!=$(t[0]).attr("tabindex")&&$(t)[0].focus(),n=!0}return n}}],backdrop:"static",resolve:{originalSettings:function(){return angular.copy(n.vxConfig.columnDefConfigs)}}});e.result.then(function(e){e=n.calculateEffectiveWidths(e),n.vxConfig.columnDefConfigs=e,n.$emit("vxGridSettingsChanged",{id:n.vxConfig.id,data:e})},function(e){})},n.calculateEffectiveWidths=function(e){var t=_.reduce(e,function(e,n){var t=0;return 0==n.hidden&&(t=parseInt(n.width)),e+t},0),i=n.selfEle.find(".vxTableScrollContainer").width();return _.each(e,function(e){if(i>t){var n=parseInt(e.width)/t*(i-t);e.effectiveWidth=parseInt(e.width)+n}else e.effectiveWidth=e.width}),e},n.openJsonEditor=function(){var e=t.open({templateUrl:"template/vx-grid/vx-grid-json-editor-modal.html",windowClass:"vxGridManageColMod",controller:["$scope","$modalInstance","griddata",function(e,n,t){e.data=angular.copy(t),e.changeData=[],e.configuration={editable:!0,viewButtonClass:"btn-info",editButtonClass:"btn-success"},e.jsonOptions={mode:"code",modes:["tree","form","code","text"],history:!1},e.onChangeJSON=function(n){e.changeData=n},e.saveChangeInConfig=function(){n.close(e.changeData)},e.cancelChangeInConfig=function(){n.dismiss()}}],backdrop:"static",resolve:{griddata:function(){return angular.copy(n.vxConfig.vxData)}}});e.result.then(function(e){n.vxConfig.vxData=e,n.$emit("vxGridDataChanged",{id:n.vxConfig.id,data:e})},function(e){})},n.revealWrapToggle=function(){n.vxColSettings.revealWrapRowData=!n.vxColSettings.revealWrapRowData},n.openExport=function(){var e=[],t={},i="undefined"!=typeof n.vxConfig.exportFileName?n.vxConfig.exportFileName:"ExcelSheet",o=[],l=[];_.each(n.vxColSettings.multiSelected,function(t,i){_.each(n.vxConfig.data,function(i,o){i[n.vxColSettings.primaryId]===t&&e.push(i)})}),_.each(n.config.columnDefConfigs,function(e,n){t[e.id]=e.columnName}),angular.forEach(t,function(e,n){if(!e||!n)throw new Error("error json report fields");o.push(n),l.push(e)});var r=f(e,o),a=s(r,l),d=new Blob([a],{type:"text/plain;charset=utf-8"});return saveAs(d,[i+".csv"])},n.xsReset=function(){n.vxColSettings.xsSearch=""},n.justScrollTop=function(){var e=n.selfEle.find(".vxTableContainer.scrollTableContainer");o(function(){$(e).animate({scrollTop:0},500)},100)},n.justScrollDown=function(){var e=n.selfEle.find(".vxTableContainer.scrollTableContainer"),t=$(e).scrollTop()||0;o(function(){$(e).animate({scrollTop:t+96},500)},100)},n.showScrollDownArrow=function(){var e=n.selfEle.find(".vxTableContainer.scrollTableContainer"),t=n.selfEle.find(".scrollTableContainer table.vxTable");return"undefined"!=typeof e&&"undefined"!=typeof t&&null!=e&&null!=t&&t.height()>e.height()?!0:!1},n.showScrollUpArrow=function(){var e=n.selfEle.find(".vxTableContainer.scrollTableContainer"),t=n.selfEle.find(".scrollTableContainer table.vxTable");return"undefined"!=typeof e&&"undefined"!=typeof t&&null!=e&&null!=t&&t.height()>e.height()&&e.scrollTop()>48?!0:!1},n.outsideHeader=function(e){1==n.vxColSettings.dropdDownOpen[e.id]&&(n.vxColSettings.dropdDownOpen[e.id]=!1,n.$$phase||n.$apply())},n.$on("vsRepeatCollectionPartiallyRendered",function(e,t){n.$emit("vxPartiallyRendered",{id:n.vxConfig.id,data:t}),1==n.vxConfig.selectAllOnRenderAll&&(n.vxColSettings.selectAllEnabled=!1,n.$emit("vxPartiallyRenderedSelectAllDisabled",{id:n.vxConfig.id,data:t}))}),n.$on("vsRepeatCollectionCompletelyRendered",function(e,t){n.$emit("vxCompletelyRendered",{id:n.vxConfig.id,data:t}),1==n.vxConfig.selectAllOnRenderAll&&(n.vxColSettings.selectAllEnabled=!0,n.$emit("vxCompletelyRenderedSelectAllEnabled",{id:n.vxConfig.id,data:t}))}),n.buildFns=function(){var e=["openJsonEditor","openManageColumns","resetVxInstance","clearFilters","selectAllFiltered","clearSelection","revealWrapToggle"];_.each(e,function(e){var t="vxGrid"+e.capitalizeFirstLetter(),i=e+"()";n.$on(t,function(e,t){0==t.id.localeCompare(n.vxConfig.id)&&n.$eval(i)}),n.config[e]=function(){n.$eval(i)}})},n.$on("vxGridChangeRowClass",function(e,t){0==t.id.localeCompare(n.vxConfig.id)&&n.changeRowClass(t.data)}),n.changeRowClass=function(e){for(var t in e)n.vxColSettings.vxRowClass[t]=e[t];"$apply"!=n.$root.$$phase&&"$digest"!=n.$root.$$phase&&n.$apply()},n.$on("vxGridResetRowClass",function(e,t){0==t.id.localeCompare(n.vxConfig.id)&&(n.vxColSettings.vxRowClass={})}),n.$on("vxGridDisableRowSelection",function(e,t){0==t.id.localeCompare(n.vxConfig.id)&&_.each(t.data,function(e){n.vxColSettings.vxRowSelectionDisable[e.key]=e.value})}),n.$on("vxGridResetDisableRowSelection",function(e,t){if(0==t.id.localeCompare(n.vxConfig.id))for(var i in n.vxColSettings.vxRowSelectionDisable)n.vxColSettings.vxRowSelectionDisable[i]=!1})}],replace:!0,templateUrl:"template/vx-grid/vx-grid.html",link:function(e,n,t){e.selfEle=n,e.$watchCollection("config.data",function(n){0==n.length&&(n=[{fillEmptyElement:!0}]),e.config.vxData=angular.copy(n),e.resetVxInstance()}),e.$watchCollection("vxConfig.vxFilteredData",function(n){n.length>=0&&1==e.vxConfig.pagination&&(e.vxColSettings.pages=_.range(Math.ceil(n.length/parseInt(e.vxConfig.pageLength))),e.vxColSettings.vxPageEnabled=e.vxColSettings.pages.length>1,e.vxColSettings.activePage=0,e.vxColSettings.vxPageStartPosition=0)}),e.getvxTableContainerWidth=function(){var e=angular.element($(n).find(".vx-scroller")[0]);return e.width()+"px"},e.getNonHiddenColCount=function(){var n=1;return"undefined"!=typeof e.vxConfig.columnDefConfigs&&e.vxConfig.columnDefConfigs.length>0&&(n=_.filter(e.vxConfig.columnDefConfigs,function(e){return 0==e.hidden}).length),n}}}}).directive("vxCompile",["$compile",function(e){return function(n,t,i){n.$watch(function(e){return e.$eval(i.vxCompile)},function(i){t.html(i),e(t.contents())(n)})}}]).directive("vxCompileCloneLink",["$compile",function(e){var n={},t={};return function(i,o,l){var r=null;l.vxCompileCloneLink in n?r=t[l.vxCompileCloneLink]:(t[l.vxCompileCloneLink]=i.$eval(l.vxCompileCloneLink),r=t[l.vxCompileCloneLink]);var a=null;r in n?a=n[r]:(n[r]=e(r),a=n[r]),a(i,function(e,n){o.append(e)})}}]).directive("vxEditFocusDisable",["$rootScope","$parse",function(e,n){var t={},i={},o=["input","select","button","textarea","object"];return{restrict:"AEC",link:function(e,l,r){var a=(n(r.vxEditFocusDisable),$(l).attr("id"));e.$watch(r.vxEditFocusDisable,function(e){if(e){i[a]={available:!0,stack:[]},_.each(o,function(e){var n=$(l).find(e);n.length>0&&_.each(n,function(e){var n=$(e).attr("id");("undefined"==typeof n||null==n||""==n)&&($(e).attr("id",_.uniqueId("elemid")),n=$(e).attr("id")),i[a].stack.push(n)})});var n=$(l).find("[tabindex]");n.length>0&&_.each(n,function(e){var n=$(e).attr("tabindex");if(-1!=n&&0==_.contains(o,e.nodeName.toUpperCase())&&0==_.contains(i[a].stack,t)){var t=$(e).attr("id");("undefined"==typeof t||null==t||""==t)&&($(e).attr("id",_.uniqueId("elemid")),t=$(e).attr("id")),i[a].stack.push(t)}}),_.each(i[a].stack,function(e){t[e]=$("#"+e).attr("tabindex")||0,$("#"+e).attr("tabindex",-1)})}else 0==e&&"undefined"!=typeof i[a]&&"undefined"!=typeof i[a].available&&1==i[a].available&&(_.each(i[a].stack,function(e){var n=t[e];$("#"+e).attr("tabindex",n)}),i[a].available=!1)})}}}]).directive("vxKey",["$rootScope","$parse",function(e,n){return{restrict:"AEC",compile:function(t,i){var o=n(i.vxKey);return function(n,t){function l(t){var i=function(){o(n,{$event:t})};e.$$phase?n.$evalAsync(i):n.$apply(i)}t.attr("role")||t.attr("role","button"),t.attr("tabindex")||t.attr("tabindex",0),t.on("click",function(e){1==i.vxDisabled||i.ngDisabled||l(e)}),t.on("keyup",function(e){1==i.vxDisabled||i.ngDisabled||(13==e.keyCode||32==e.keyCode)&&l(e)})}}}}]).directive("vxKeepWatch",function(){return{restrict:"AEC",link:function(e,n,t){var i=t.vxKeepWatch,o=!1;e.$watch(t[i],function(n){o?e.$emit("vxInlineEditFieldChange",{field:t.vxKeepWatchField,value:n,rowId:t.vxKeepWatchRowId}):o=!0})}}}).filter("vxGridMultiBoxFilters",function(){return function(e,n){if("undefined"!=typeof n&&null!=n&&n.length>0){var t=e,i=e,o=_.groupBy(n,"col");for(var l in o){var r=o[l],a=[];_.each(r,function(e){a=_.union(a,_.filter(i,function(n){return"undefined"!=typeof e.label&&null!=e.label&&e.label!={}&&"undefined"!=typeof n[e.col]&&null!=n[e.col]&&n[e.col]!={}?"date"==e.type?n[e.col].getTime()==e.label:"object"==e.type?0==JSON.stringify(n[e.col]).localeCompare(JSON.stringify(e.label)):0==n[e.col].toString().trim().localeCompare(e.label):n[e.col]==e.label}))}),t=_.intersection(t,a)}return t}return e}}).directive("clickOutsideHeader",["$document","$parse",function(e,n){return{restrict:"A",link:function(t,i,o){var l=void 0!==o.outsideIfNot?o.outsideIfNot.replace(", ",",").split(","):[];void 0!==o.id&&l.push(o.id);var r=n(o.clickOutsideHeader);e.on("click",function(e){try{var n=$(e.target).closest("th.vxHeadRowCell");("undefined"==typeof n||null==n||0==n.length)&&t.$eval(o.checkClickOutside)&&t.$eval(r)}catch(e){console.log(e)}})}}}]).filter("vxNumberFixedLen",function(){return function(e,n){var t=parseInt(e,10);if(n=parseInt(n,10),isNaN(t)||isNaN(n))return e;for(t=""+t;t.length<n;)t="0"+t;return t}}).filter("vxStartFrom",function(){return function(e,n){if(e){n=+n;var t=e.slice(n);return t}return[]}})}();